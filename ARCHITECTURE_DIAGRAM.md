# Payvost Web - Architecture & Integration Status

## Current Architecture (Disconnected)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (Next.js)                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Dashboard    â”‚  â”‚   Payments     â”‚  â”‚    Wallets     â”‚   â”‚
â”‚  â”‚   Components   â”‚  â”‚   Components   â”‚  â”‚   Components   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                   â”‚                    â”‚            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                               â”‚                                  â”‚
â”‚                               â–¼                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   Firebase/Firestore â”‚ â—„â”€â”€ Currently Used  â”‚
â”‚                    â”‚   (Direct Access)    â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ âŒ NOT CONNECTED
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Microservices)                       â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              API Gateway (Express)                        â”‚  â”‚
â”‚  â”‚              Port 3001                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚      â”‚      â”‚      â”‚      â”‚      â”‚      â”‚               â”‚
â”‚       â–¼      â–¼      â–¼      â–¼      â–¼      â–¼      â–¼               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚Walletâ”‚â”‚Trans.â”‚â”‚Paymntâ”‚â”‚ User â”‚â”‚Fraud â”‚â”‚Curr. â”‚â”‚Notif.â”‚   â”‚
â”‚   â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚   â”‚
â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜   â”‚
â”‚      â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚         â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                               â”‚                                  â”‚
â”‚                               â–¼                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   PostgreSQL + Prismaâ”‚ â—„â”€â”€ Not Used        â”‚
â”‚                    â”‚   (Ready but Unused) â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Target Architecture (Fully Wired)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND (Next.js)                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Dashboard    â”‚  â”‚   Payments     â”‚  â”‚    Wallets     â”‚   â”‚
â”‚  â”‚   Components   â”‚  â”‚   Components   â”‚  â”‚   Components   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                   â”‚                    â”‚            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                               â”‚                                  â”‚
â”‚                               â–¼                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚  API Service Layer   â”‚ â—„â”€â”€ TO BE CREATED   â”‚
â”‚                    â”‚  (apiClient.ts)      â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                               â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            Firebase Auth (Token Provider)                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                               â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ âœ… FULLY CONNECTED
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Microservices)                       â”‚
â”‚                               â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              API Gateway (Express)                         â”‚  â”‚
â”‚  â”‚              - JWT Verification                            â”‚  â”‚
â”‚  â”‚              - Rate Limiting                               â”‚  â”‚
â”‚  â”‚              - Request Logging                             â”‚  â”‚
â”‚  â”‚              - Error Handling                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚      â”‚      â”‚      â”‚      â”‚      â”‚      â”‚               â”‚
â”‚       â–¼      â–¼      â–¼      â–¼      â–¼      â–¼      â–¼               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚Walletâ”‚â”‚Trans.â”‚â”‚Paymntâ”‚â”‚ User â”‚â”‚Fraud â”‚â”‚Curr. â”‚â”‚Notif.â”‚   â”‚
â”‚   â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚â”‚ Svc  â”‚   â”‚
â”‚   â”‚  âœ…  â”‚â”‚  âœ…  â”‚â”‚  âœ…  â”‚â”‚  âœ…  â”‚â”‚  âœ…  â”‚â”‚  âœ…  â”‚â”‚  âœ…  â”‚   â”‚
â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜â””â”€â”€â”¬â”€â”€â”€â”˜   â”‚
â”‚      â”‚       â”‚       â”‚       â”‚       â”‚       â”‚       â”‚         â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                               â”‚                                  â”‚
â”‚                               â–¼                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   PostgreSQL + Prismaâ”‚                     â”‚
â”‚                    â”‚   - Users            â”‚                     â”‚
â”‚                    â”‚   - Accounts         â”‚                     â”‚
â”‚                    â”‚   - Transactions     â”‚                     â”‚
â”‚                    â”‚   - Ledger Entries   â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            External Integrations                        â”‚    â”‚
â”‚  â”‚  - Stripe/FedNow/SEPA (Payment Providers)             â”‚    â”‚
â”‚  â”‚  - Currency Exchange API                               â”‚    â”‚
â”‚  â”‚  - Email Service (SendGrid/SES)                        â”‚    â”‚
â”‚  â”‚  - Bill Payment Providers                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow - Current vs Target

### Current: Money Transfer Flow (BROKEN)

```
User clicks "Send Money"
         â”‚
         â–¼
   Payvost.tsx
   handleSendMoney()
         â”‚
         â–¼
   setTimeout(2000)  â—„â”€â”€ âŒ SIMULATED
         â”‚
         â–¼
   Show success message
   (NO ACTUAL TRANSFER)
```

### Target: Money Transfer Flow (CORRECT)

```
User clicks "Send Money"
         â”‚
         â–¼
   Payvost.tsx
   handleSendMoney()
         â”‚
         â–¼
   apiClient.post('/api/transaction/create')
         â”‚
         â–¼
   API Gateway
   - Verify JWT token
   - Check rate limits
         â”‚
         â–¼
   Transaction Service
   - Validate balance
   - Check KYC status
         â”‚
         â”œâ”€â”€â–º Fraud Service
         â”‚    - Check risk score
         â”‚    - Detect anomalies
         â”‚
         â”œâ”€â”€â–º Currency Service
         â”‚    - Get exchange rate
         â”‚    - Calculate amount
         â”‚
         â–¼
   PostgreSQL Transaction
   - Debit sender account
   - Credit recipient account
   - Create ledger entries
   - Record transaction
         â”‚
         â”œâ”€â”€â–º Notification Service
         â”‚    - Email receipt
         â”‚    - Push notification
         â”‚
         â–¼
   Return success response
         â”‚
         â–¼
   Update frontend UI
   Show actual transaction details
```

## Service Integration Map

### Wallet Service

```
Frontend Components          Backend Service          Database
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
wallets/page.tsx     â”€â”€â–º  /api/wallet/accounts  â”€â”€â–º  Account
fund-wallet-dialog   â”€â”€â–º  /api/wallet/fund     â”€â”€â–º  LedgerEntry
create-wallet-dialog â”€â”€â–º  /api/wallet/accounts â”€â”€â–º  Account
                          (POST)

Current Status: âŒ Not connected (uses Firebase)
Time to Wire:   3 hours
Priority:       ğŸ”´ Critical
```

### Transaction Service

```
Frontend Components          Backend Service              Database
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Payvost.tsx          â”€â”€â–º  /api/transaction/create  â”€â”€â–º  Transfer
transactions/page    â”€â”€â–º  /api/transaction/user    â”€â”€â–º  Transfer
transaction/[id]     â”€â”€â–º  /api/transaction/:id     â”€â”€â–º  Transfer

Current Status: âŒ Not connected (simulated)
Time to Wire:   4 hours
Priority:       ğŸ”´ Critical
```

### Payment Service

```
Frontend Components          Backend Service              External
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
payments/page.tsx    â”€â”€â–º  /api/payment/create-intent â”€â”€â–º Stripe
donate/[id]          â”€â”€â–º  /api/payment/status/:id    â”€â”€â–º FedNow
pay/[id]             â”€â”€â–º  /api/payment/webhook       â”€â”€â–º SEPA

Current Status: âš ï¸ Partially connected
Time to Wire:   8 hours
Priority:       ğŸ”´ Critical
```

### Currency Service

```
Frontend Components          Backend Service          External
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Payvost.tsx          â”€â”€â–º  /api/currency/rates  â”€â”€â–º ExchangeRate-API
wallets/page.tsx     â”€â”€â–º  /api/currency/rates  â”€â”€â–º (Cached)
payments/page.tsx    â”€â”€â–º  /api/currency/convert

Current Status: âŒ Not connected (hardcoded)
Time to Wire:   2 hours
Priority:       ğŸ”´ Critical
```

### Fraud Service

```
Transaction Flow             Fraud Service
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Before transfer      â”€â”€â–º  /api/fraud/check
  - Amount                 - Risk scoring
  - User history          - Anomaly detection
  - Device info           - Pattern matching
                          - Velocity checks

Current Status: âŒ Not integrated
Time to Wire:   4 hours
Priority:       ğŸŸ¡ High
```

## Component â†’ Service Mapping

### Critical Components (Wire First)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component                    â”‚ Service Needed    â”‚ Priority â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Payvost.tsx                  â”‚ Transaction       â”‚ ğŸ”´ Crit  â”‚
â”‚ wallets/page.tsx             â”‚ Wallet            â”‚ ğŸ”´ Crit  â”‚
â”‚ payments/page.tsx            â”‚ Payment           â”‚ ğŸ”´ Crit  â”‚
â”‚ All (exchange rates)         â”‚ Currency          â”‚ ğŸ”´ Crit  â”‚
â”‚ cards/page.tsx               â”‚ Card (new)        â”‚ ğŸŸ¡ High  â”‚
â”‚ transactions/page.tsx        â”‚ Transaction       â”‚ ğŸŸ¡ High  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Integration Dependencies

```
                    API Service Layer
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚            â”‚            â”‚
              â–¼            â–¼            â–¼
         Fix TS Errors  Auth Flow   Error Handler
              â”‚            â”‚            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                         â”‚
              â–¼                         â–¼
        Wallet Service          Transaction Service
              â”‚                         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                  Currency Service
                           â”‚
                           â–¼
                  Fraud Detection
                           â”‚
                           â–¼
                  All Other Services
```

## Database Schema Overview

### Current (Firebase)

```
users/{uid}
  â”œâ”€ wallets: []
  â”œâ”€ cards: []
  â”œâ”€ transactions: []
  â””â”€ beneficiaries: []
```

### Target (PostgreSQL)

```
User
  â”œâ”€ Account[] (wallets)
  â”‚    â””â”€ LedgerEntry[] (balance changes)
  â”œâ”€ Transfer[] (transactions)
  â”‚    â””â”€ TransferStatusUpdate[]
  â”œâ”€ Card[]
  â”‚    â””â”€ CardTransaction[]
  â””â”€ Beneficiary[]
```

## File Structure - Before & After

### Before (No Service Layer)

```
src/
â”œâ”€ components/
â”‚  â””â”€ Payvost.tsx  â”€â”€â–º Firebase directly âŒ
â”œâ”€ app/
â”‚  â””â”€ dashboard/
â”‚     â””â”€ wallets/
â”‚        â””â”€ page.tsx  â”€â”€â–º Firebase directly âŒ
```

### After (With Service Layer)

```
src/
â”œâ”€ services/          â—„â”€â”€ NEW
â”‚  â”œâ”€ apiClient.ts    â—„â”€â”€ Base HTTP client
â”‚  â”œâ”€ walletService.ts
â”‚  â”œâ”€ transactionService.ts
â”‚  â”œâ”€ paymentService.ts
â”‚  â””â”€ currencyService.ts
â”œâ”€ components/
â”‚  â””â”€ Payvost.tsx  â”€â”€â–º transactionService.create() âœ…
â”œâ”€ app/
â”‚  â””â”€ dashboard/
â”‚     â””â”€ wallets/
â”‚        â””â”€ page.tsx  â”€â”€â–º walletService.getAll() âœ…
```

## Progress Tracking

### Phase 1: Foundation
```
[ ] Create API service layer
[ ] Fix TypeScript errors
[ ] Set up auth flow
[ ] Implement error handling
```

### Phase 2: Core Services
```
[ ] Wire wallet service (3 hours)
[ ] Wire transaction service (4 hours)
[ ] Integrate currency API (2 hours)
[ ] Connect payment service (8 hours)
```

### Phase 3: Additional Services
```
[ ] Integrate fraud detection (4 hours)
[ ] Set up email service (16 hours)
[ ] Wire notification service (8 hours)
```

### Phase 4: Complete Features
```
[ ] All forms have handlers
[ ] All simulations removed
[ ] All TypeScript errors fixed
[ ] All tests passing
[ ] All documentation updated
```

## Success Metrics

```
Before:
- Simulated APIs: 5
- Backend Connected: 0%
- TS Errors: 35+
- Forms Complete: 45%

After:
- Simulated APIs: 0 âœ…
- Backend Connected: 100% âœ…
- TS Errors: 0 âœ…
- Forms Complete: 100% âœ…
```

---

**Next Step:** Create the API service layer â†’ See QUICK_WIRING_GUIDE.md
